//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package document ;import (_c "encoding/binary";_e "fmt";_ec "github.com/unidoc/unipdf/v3/common";_ba "github.com/unidoc/unipdf/v3/internal/bitwise";_d "github.com/unidoc/unipdf/v3/internal/jbig2/basic";_fb "github.com/unidoc/unipdf/v3/internal/jbig2/bitmap";_ea "github.com/unidoc/unipdf/v3/internal/jbig2/document/segments";_ff "github.com/unidoc/unipdf/v3/internal/jbig2/encoder/classer";_fbe "github.com/unidoc/unipdf/v3/internal/jbig2/errors";_eg "io";_b "math";_f "runtime/debug";);func (_eag *Document )isFileHeaderPresent ()(bool ,error ){_eag .InputStream .Mark ();for _ ,_ebd :=range _ffb {_eae ,_cea :=_eag .InputStream .ReadByte ();if _cea !=nil {return false ,_cea ;};if _ebd !=_eae {_eag .InputStream .Reset ();return false ,nil ;};};_eag .InputStream .Reset ();return true ,nil ;};func _gce (_bea _ba .StreamReader ,_bbd *Globals )(*Document ,error ){_fbf :=&Document {Pages :make (map[int ]*Page ),InputStream :_bea ,OrganizationType :_ea .OSequential ,NumberOfPagesUnknown :true ,GlobalSegments :_bbd ,_gd :9};if _fbf .GlobalSegments ==nil {_fbf .GlobalSegments =&Globals {};};if _bba :=_fbf .mapData ();_bba !=nil {return nil ,_bba ;};return _fbf ,nil ;};func (_dagdd *Document )encodeSegment (_fea *_ea .Header ,_dge *int )error {const _cfc ="\u0065\u006e\u0063\u006f\u0064\u0065\u0053\u0065\u0067\u006d\u0065\u006e\u0074";_fea .SegmentNumber =_dagdd .nextSegmentNumber ();_ac ,_afd :=_fea .Encode (_dagdd ._de );if _afd !=nil {return _fbe .Wrapf (_afd ,_cfc ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0027\u0025\u0064\u0027",_fea .SegmentNumber );};*_dge +=_ac ;return nil ;};type Page struct{Segments []*_ea .Header ;PageNumber int ;Bitmap *_fb .Bitmap ;FinalHeight int ;FinalWidth int ;ResolutionX int ;ResolutionY int ;IsLossless bool ;Document *Document ;FirstSegmentNumber int ;EncodingMethod EncodingMethod ;};func (_dff *Document )encodeFileHeader (_fgc _ba .BinaryWriter )(_cac int ,_fdbb error ){const _acb ="\u0065\u006ec\u006f\u0064\u0065F\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_cac ,_fdbb =_fgc .Write (_ffb );if _fdbb !=nil {return _cac ,_fbe .Wrap (_fdbb ,_acb ,"\u0069\u0064");};if _fdbb =_fgc .WriteByte (0x01);_fdbb !=nil {return _cac ,_fbe .Wrap (_fdbb ,_acb ,"\u0066\u006c\u0061g\u0073");};_cac ++;_ebb :=make ([]byte ,4);_c .BigEndian .PutUint32 (_ebb ,_dff .NumberOfPages );_gac ,_fdbb :=_fgc .Write (_ebb );if _fdbb !=nil {return _gac ,_fbe .Wrap (_fdbb ,_acb ,"p\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};_cac +=_gac ;return _cac ,nil ;};func (_egg *Page )getResolutionY ()(int ,error ){const _gaca ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0059";if _egg .ResolutionY !=0{return _egg .ResolutionY ,nil ;};_bgc :=_egg .getPageInformationSegment ();if _bgc ==nil {return 0,_fbe .Error (_gaca ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_aea ,_eab :=_bgc .GetSegmentData ();if _eab !=nil {return 0,_fbe .Wrap (_eab ,_gaca ,"");};_gcda ,_bbdg :=_aea .(*_ea .PageInformationSegment );if !_bbdg {return 0,_fbe .Errorf (_gaca ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0074\u0079\u0070\u0065\u003a\u0027%\u0054\u0027",_aea );};_egg .ResolutionY =_gcda .ResolutionY ;return _egg .ResolutionY ,nil ;};func (_dgga *Page )addTextRegionSegment (_abd []*_ea .Header ,_fccf ,_dcg map[int ]int ,_cca []int ,_gbef *_fb .Points ,_gbge *_fb .Bitmaps ,_ggdf *_d .IntSlice ,_bac *_fb .Boxes ,_ecce ,_gagg int ){_cce :=&_ea .TextRegion {NumberOfSymbols :uint32 (_gagg )};_cce .InitEncode (_fccf ,_dcg ,_cca ,_gbef ,_gbge ,_ggdf ,_bac ,_dgga .FinalWidth ,_dgga .FinalHeight ,_ecce );_cfba :=&_ea .Header {RTSegments :_abd ,SegmentData :_cce ,PageAssociation :_dgga .PageNumber ,Type :_ea .TImmediateTextRegion };_aad :=_ea .TPageInformation ;if _dcg !=nil {_aad =_ea .TSymbolDictionary ;};var _afe int ;for ;_afe < len (_dgga .Segments );_afe ++{if _dgga .Segments [_afe ].Type ==_aad {_afe ++;break ;};};_dgga .Segments =append (_dgga .Segments ,nil );copy (_dgga .Segments [_afe +1:],_dgga .Segments [_afe :]);_dgga .Segments [_afe ]=_cfba ;};func (_dfd *Page )createPage (_ggg *_ea .PageInformationSegment )error {var _eafg error ;if !_ggg .IsStripe ||_ggg .PageBMHeight !=-1{_eafg =_dfd .createNormalPage (_ggg );}else {_eafg =_dfd .createStripedPage (_ggg );};return _eafg ;};func (_efcb *Page )createStripedPage (_bfg *_ea .PageInformationSegment )error {const _ecb ="\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0074\u0072\u0069\u0070\u0065d\u0050\u0061\u0067\u0065";_bbe ,_faae :=_efcb .collectPageStripes ();if _faae !=nil {return _fbe .Wrap (_faae ,_ecb ,"");};var _abab int ;for _ ,_fgf :=range _bbe {if _cggd ,_dac :=_fgf .(*_ea .EndOfStripe );_dac {_abab =_cggd .LineNumber ()+1;}else {_cagg :=_fgf .(_ea .Regioner );_cbc :=_cagg .GetRegionInfo ();_eec :=_efcb .getCombinationOperator (_bfg ,_cbc .CombinaionOperator );_gdac ,_efdf :=_cagg .GetRegionBitmap ();if _efdf !=nil {return _fbe .Wrap (_efdf ,_ecb ,"");};_efdf =_fb .Blit (_gdac ,_efcb .Bitmap ,int (_cbc .XLocation ),_abab ,_eec );if _efdf !=nil {return _fbe .Wrap (_efdf ,_ecb ,"");};};};return nil ;};const (GenericEM EncodingMethod =iota ;CorrelationEM ;RankHausEM ;);func (_edf *Document )GetGlobalSegment (i int )(*_ea .Header ,error ){_dad ,_aedc :=_edf .GlobalSegments .GetSegment (i );if _aedc !=nil {return nil ,_fbe .Wrap (_aedc ,"\u0047\u0065t\u0047\u006c\u006fb\u0061\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074","");};return _dad ,nil ;};func (_dde *Page )Encode (w _ba .BinaryWriter )(_fae int ,_fbeb error ){const _bee ="P\u0061\u0067\u0065\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _gdg int ;for _ ,_gee :=range _dde .Segments {if _gdg ,_fbeb =_gee .Encode (w );_fbeb !=nil {return _fae ,_fbe .Wrap (_fbeb ,_bee ,"");};_fae +=_gdg ;};return _fae ,nil ;};func (_dfg *Page )GetResolutionY ()(int ,error ){return _dfg .getResolutionY ()};var _ffb =[]byte {0x97,0x4A,0x42,0x32,0x0D,0x0A,0x1A,0x0A};func (_ddc *Page )countRegions ()int {var _fbg int ;for _ ,_bccg :=range _ddc .Segments {switch _bccg .Type {case 6,7,22,23,38,39,42,43:_fbg ++;};};return _fbg ;};func (_ecg *Page )AddGenericRegion (bm *_fb .Bitmap ,xloc ,yloc ,template int ,tp _ea .Type ,duplicateLineRemoval bool )error {const _addfc ="P\u0061\u0067\u0065\u002eAd\u0064G\u0065\u006e\u0065\u0072\u0069c\u0052\u0065\u0067\u0069\u006f\u006e";_ebbe :=&_ea .GenericRegion {};if _aecb :=_ebbe .InitEncode (bm ,xloc ,yloc ,template ,duplicateLineRemoval );_aecb !=nil {return _fbe .Wrap (_aecb ,_addfc ,"");};_bgd :=&_ea .Header {Type :_ea .TImmediateGenericRegion ,PageAssociation :_ecg .PageNumber ,SegmentData :_ebbe };_ecg .Segments =append (_ecg .Segments ,_bgd );return nil ;};func InitEncodeDocument (fullHeaders bool )*Document {return &Document {FullHeaders :fullHeaders ,_de :_ba .BufferedMSB (),Pages :map[int ]*Page {},_ge :map[int ][]int {},_eac :map[int ]int {},_fd :map[int ][]int {}};};func (_bae *Document )reachedEOF (_ccd int64 )(bool ,error ){const _gacc ="\u0072\u0065\u0061\u0063\u0068\u0065\u0064\u0045\u004f\u0046";_ ,_ffa :=_bae .InputStream .Seek (_ccd ,_eg .SeekStart );if _ffa !=nil {_ec .Log .Debug ("\u0072\u0065\u0061c\u0068\u0065\u0064\u0045\u004f\u0046\u0020\u002d\u0020\u0064\u002e\u0049\u006e\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u002e\u0053\u0065\u0065\u006b\u0020\u0066a\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_ffa );return false ,_fbe .Wrap (_ffa ,_gacc ,"\u0069n\u0070\u0075\u0074\u0020\u0073\u0074\u0072\u0065\u0061\u006d\u0020s\u0065\u0065\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};_ ,_ffa =_bae .InputStream .ReadBits (32);if _ffa ==_eg .EOF {return true ,nil ;}else if _ffa !=nil {return false ,_fbe .Wrap (_ffa ,_gacc ,"");};return false ,nil ;};func (_cee *Page )createNormalPage (_ceae *_ea .PageInformationSegment )error {const _fdf ="\u0063\u0072e\u0061\u0074\u0065N\u006f\u0072\u006d\u0061\u006c\u0050\u0061\u0067\u0065";_cee .Bitmap =_fb .New (_ceae .PageBMWidth ,_ceae .PageBMHeight );if _ceae .DefaultPixelValue ()!=0{_cee .Bitmap .SetDefaultPixel ();};for _ ,_cefb :=range _cee .Segments {switch _cefb .Type {case 6,7,22,23,38,39,42,43:_ec .Log .Trace ("\u0047\u0065\u0074\u0074in\u0067\u0020\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0064",_cefb .SegmentNumber );_aca ,_fff :=_cefb .GetSegmentData ();if _fff !=nil {return _fff ;};_dfbg ,_bada :=_aca .(_ea .Regioner );if !_bada {_ec .Log .Debug ("\u0053\u0065g\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0054\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0052\u0065\u0067\u0069on\u0065\u0072",_aca );return _fbe .Errorf (_fdf ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062i\u0067\u0032\u0020\u0073\u0065\u0067\u006den\u0074\u0020\u0074\u0079p\u0065\u0020\u002d\u0020\u006e\u006f\u0074\u0020\u0061 R\u0065\u0067i\u006f\u006e\u0065\u0072\u003a\u0020\u0025\u0054",_aca );};_cbg ,_fff :=_dfbg .GetRegionBitmap ();if _fff !=nil {return _fbe .Wrap (_fff ,_fdf ,"");};if _cee .fitsPage (_ceae ,_cbg ){_cee .Bitmap =_cbg ;}else {_dga :=_dfbg .GetRegionInfo ();_afgb :=_cee .getCombinationOperator (_ceae ,_dga .CombinaionOperator );_fff =_fb .Blit (_cbg ,_cee .Bitmap ,int (_dga .XLocation ),int (_dga .YLocation ),_afgb );if _fff !=nil {return _fbe .Wrap (_fff ,_fdf ,"");};};};};return nil ;};func (_gae *Page )nextSegmentNumber ()uint32 {return _gae .Document .nextSegmentNumber ()};type Globals struct{Segments []*_ea .Header ;};func (_cfe *Document )completeSymbols ()(_gbg error ){const _bf ="\u0063o\u006dp\u006c\u0065\u0074\u0065\u0053\u0079\u006d\u0062\u006f\u006c\u0073";if _cfe .Classer ==nil {return nil ;};if _cfe .Classer .UndilatedTemplates ==nil {return _fbe .Error (_bf ,"\u006e\u006f t\u0065\u006d\u0070l\u0061\u0074\u0065\u0073 de\u0066in\u0065\u0064\u0020\u0066\u006f\u0072\u0020th\u0065\u0020\u0063\u006c\u0061\u0073\u0073e\u0072");};_gad :=len (_cfe .Pages )==1;_gfa :=make ([]int ,_cfe .Classer .UndilatedTemplates .Size ());var _ffbd int ;for _cada :=0;_cada < _cfe .Classer .ClassIDs .Size ();_cada ++{_ffbd ,_gbg =_cfe .Classer .ClassIDs .Get (_cada );if _gbg !=nil {return _fbe .Wrap (_gbg ,_bf ,"\u0063\u006c\u0061\u0073\u0073\u0020\u0049\u0044\u0027\u0073");};_gfa [_ffbd ]++;};var _eacc []int ;for _gcd :=0;_gcd < _cfe .Classer .UndilatedTemplates .Size ();_gcd ++{if _gfa [_gcd ]==0{return _fbe .Error (_bf ,"\u006eo\u0020\u0073y\u006d\u0062\u006f\u006cs\u0020\u0069\u006es\u0074\u0061\u006e\u0063\u0065\u0073\u0020\u0066\u006fun\u0064\u0020\u0066o\u0072\u0020g\u0069\u0076\u0065\u006e\u0020\u0063l\u0061\u0073s\u003f\u0020");};if _gfa [_gcd ]> 1||_gad {_eacc =append (_eacc ,_gcd );};};_cfe ._gb =len (_eacc );var _gaf ,_gafc int ;for _dagd :=0;_dagd < _cfe .Classer .ComponentPageNumbers .Size ();_dagd ++{_gaf ,_gbg =_cfe .Classer .ComponentPageNumbers .Get (_dagd );if _gbg !=nil {return _fbe .Wrapf (_gbg ,_bf ,"p\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027 \u006e\u006f\u0074\u0020\u0066\u006f\u0075nd\u0020\u0069\u006e\u0020t\u0068\u0065\u0020\u0063\u006c\u0061\u0073\u0073\u0065r \u0070\u0061g\u0065\u006e\u0075\u006d\u0062\u0065\u0072\u0073",_dagd );};_gafc ,_gbg =_cfe .Classer .ClassIDs .Get (_dagd );if _gbg !=nil {return _fbe .Wrapf (_gbg ,_bf ,"\u0063\u0061\u006e\u0027\u0074\u0020\u0067e\u0074\u0020\u0073y\u006d\u0062\u006f\u006c \u0066\u006f\u0072\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u006c\u0061\u0073\u0073\u0065\u0072",_gaf );};if _gfa [_gafc ]==1&&!_gad {_cfe ._ge [_gaf ]=append (_cfe ._ge [_gaf ],_gafc );};};if _gbg =_cfe .Classer .ComputeLLCorners ();_gbg !=nil {return _fbe .Wrap (_gbg ,_bf ,"");};return nil ;};func (_ffg *Globals )GetSegmentByIndex (index int )(*_ea .Header ,error ){const _bgb ="\u0047l\u006f\u0062\u0061\u006cs\u002e\u0047\u0065\u0074\u0053e\u0067m\u0065n\u0074\u0042\u0079\u0049\u006e\u0064\u0065x";if _ffg ==nil {return nil ,_fbe .Error (_bgb ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_ffg .Segments )==0{return nil ,_fbe .Error (_bgb ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};if index > len (_ffg .Segments )-1{return nil ,_fbe .Error (_bgb ,"\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");};return _ffg .Segments [index ],nil ;};func (_cgf *Page )GetBitmap ()(_dce *_fb .Bitmap ,_bab error ){_ec .Log .Trace (_e .Sprintf ("\u005b\u0050\u0041G\u0045\u005d\u005b\u0023%\u0064\u005d\u0020\u0047\u0065\u0074\u0042i\u0074\u006d\u0061\u0070\u0020\u0062\u0065\u0067\u0069\u006e\u0073\u002e\u002e\u002e",_cgf .PageNumber ));defer func (){if _bab !=nil {_ec .Log .Trace (_e .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064\u005d\u0020\u0047\u0065\u0074B\u0069t\u006d\u0061\u0070\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u002e\u0020\u0025\u0076",_cgf .PageNumber ,_bab ));}else {_ec .Log .Trace (_e .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064]\u0020\u0047\u0065\u0074\u0042\u0069\u0074m\u0061\u0070\u0020\u0066\u0069\u006e\u0069\u0073\u0068\u0065\u0064",_cgf .PageNumber ));};}();if _cgf .Bitmap !=nil {return _cgf .Bitmap ,nil ;};_bab =_cgf .composePageBitmap ();if _bab !=nil {return nil ,_bab ;};return _cgf .Bitmap ,nil ;};func (_fdb *Document )produceClassifiedPages ()(_gga error ){const _ece ="\u0070\u0072\u006f\u0064uc\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067e\u0073";if _fdb .Classer ==nil {return nil ;};var (_aed *Page ;_bad bool ;_fa *_ea .Header ;);for _ce :=1;_ce <=int (_fdb .NumberOfPages );_ce ++{if _aed ,_bad =_fdb .Pages [_ce ];!_bad {return _fbe .Errorf (_ece ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_ce );};if _aed .EncodingMethod ==GenericEM {continue ;};if _fa ==nil {if _fa ,_gga =_fdb .GlobalSegments .GetSymbolDictionary ();_gga !=nil {return _fbe .Wrap (_gga ,_ece ,"");};};if _gga =_fdb .produceClassifiedPage (_aed ,_fa );_gga !=nil {return _fbe .Wrapf (_gga ,_ece ,"\u0070\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027",_ce );};};return nil ;};func (_bag *Document )determineRandomDataOffsets (_gde []*_ea .Header ,_fad uint64 ){if _bag .OrganizationType !=_ea .ORandom {return ;};for _ ,_eeg :=range _gde {_eeg .SegmentDataStartOffset =_fad ;_fad +=_eeg .SegmentDataLength ;};};func (_ebf *Document )GetPage (pageNumber int )(_ea .Pager ,error ){const _eaf ="\u0044\u006fc\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074\u0050\u0061\u0067\u0065";if pageNumber < 0{_ec .Log .Debug ("\u004a\u0042\u0049\u00472\u0020\u0050\u0061\u0067\u0065\u0020\u002d\u0020\u0047e\u0074\u0050\u0061\u0067\u0065\u003a\u0020\u0025\u0064\u002e\u0020\u0050\u0061\u0067\u0065\u0020\u0063\u0061n\u006e\u006f\u0074\u0020\u0062e\u0020\u006c\u006f\u0077\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u0030\u002e\u0020\u0025\u0073",pageNumber ,_f .Stack ());return nil ,_fbe .Errorf (_eaf ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032\u0020d\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u002d\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064 \u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064",pageNumber );};if pageNumber > len (_ebf .Pages ){_ec .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_f .Stack ());return nil ,_fbe .Error (_eaf ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};_fga ,_gbc :=_ebf .Pages [pageNumber ];if !_gbc {_ec .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_f .Stack ());return nil ,_fbe .Errorf (_eaf ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};return _fga ,nil ;};func _cgg (_beafc *Document ,_faad int )*Page {return &Page {Document :_beafc ,PageNumber :_faad ,Segments :[]*_ea .Header {}};};func (_ggc *Page )clearSegmentData (){for _ace :=range _ggc .Segments {_ggc .Segments [_ace ].CleanSegmentData ();};};func _gbb (_edg int )int {_adgf :=0;_bg :=(_edg &(_edg -1))==0;_edg >>=1;for ;_edg !=0;_edg >>=1{_adgf ++;};if _bg {return _adgf ;};return _adgf +1;};func (_efc *Globals )AddSegment (segment *_ea .Header ){_efc .Segments =append (_efc .Segments ,segment )};func DecodeDocument (input _ba .StreamReader ,globals *Globals )(*Document ,error ){return _gce (input ,globals );};func (_ccf *Page )getResolutionX ()(int ,error ){const _bbbd ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0058";if _ccf .ResolutionX !=0{return _ccf .ResolutionX ,nil ;};_egc :=_ccf .getPageInformationSegment ();if _egc ==nil {return 0,_fbe .Error (_bbbd ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_gfba ,_agag :=_egc .GetSegmentData ();if _agag !=nil {return 0,_fbe .Wrap (_agag ,_bbbd ,"");};_fffd ,_faea :=_gfba .(*_ea .PageInformationSegment );if !_faea {return 0,_fbe .Errorf (_bbbd ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_gfba );};_ccf .ResolutionX =_fffd .ResolutionX ;return _ccf .ResolutionX ,nil ;};func (_gfb *Page )composePageBitmap ()error {const _ebe ="\u0063\u006f\u006d\u0070\u006f\u0073\u0065\u0050\u0061\u0067\u0065\u0042i\u0074\u006d\u0061\u0070";if _gfb .PageNumber ==0{return nil ;};_gdd :=_gfb .getPageInformationSegment ();if _gdd ==nil {return _fbe .Error (_ebe ,"\u0070\u0061\u0067e \u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069o\u006e \u0073e\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");};_cfg ,_gda :=_gdd .GetSegmentData ();if _gda !=nil {return _gda ;};_gddc ,_bdeg :=_cfg .(*_ea .PageInformationSegment );if !_bdeg {return _fbe .Error (_ebe ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006da\u0074\u0069\u006f\u006e \u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070\u0065");};if _gda =_gfb .createPage (_gddc );_gda !=nil {return _fbe .Wrap (_gda ,_ebe ,"");};_gfb .clearSegmentData ();return nil ;};func (_aga *Page )GetSegment (number int )(*_ea .Header ,error ){const _cgc ="\u0050a\u0067e\u002e\u0047\u0065\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074";for _ ,_beaf :=range _aga .Segments {if _beaf .SegmentNumber ==uint32 (number ){return _beaf ,nil ;};};_fdgd :=make ([]uint32 ,len (_aga .Segments ));for _ecag ,_fecc :=range _aga .Segments {_fdgd [_ecag ]=_fecc .SegmentNumber ;};return nil ,_fbe .Errorf (_cgc ,"\u0073e\u0067\u006d\u0065n\u0074\u0020\u0077i\u0074h \u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u003a\u0020'%\u0064'\u002e\u0020\u004b\u006e\u006f\u0077n\u0020\u0073\u0065\u0067\u006de\u006e\u0074\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0073\u003a \u0025\u0076",number ,_aga .PageNumber ,_fdgd );};func (_bgdag *Page )String ()string {return _e .Sprintf ("\u0050\u0061\u0067\u0065\u0020\u0023\u0025\u0064",_bgdag .PageNumber );};func (_bd *Document )AddClassifiedPage (bm *_fb .Bitmap ,method _ff .Method )(_feg error ){const _ae ="\u0044\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u002e\u0041\u0064d\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064P\u0061\u0067\u0065";if !_bd .FullHeaders &&_bd .NumberOfPages !=0{return _fbe .Error (_ae ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");};if _bd .Classer ==nil {if _bd .Classer ,_feg =_ff .Init (_ff .DefaultSettings ());_feg !=nil {return _fbe .Wrap (_feg ,_ae ,"");};};_adg :=int (_bd .nextPageNumber ());_da :=&Page {Segments :[]*_ea .Header {},Bitmap :bm ,Document :_bd ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,PageNumber :_adg };_bd .Pages [_adg ]=_da ;switch method {case _ff .RankHaus :_da .EncodingMethod =RankHausEM ;case _ff .Correlation :_da .EncodingMethod =CorrelationEM ;};_da .AddPageInformationSegment ();if _feg =_bd .Classer .AddPage (bm ,_adg ,method );_feg !=nil {return _fbe .Wrap (_feg ,_ae ,"");};if _bd .FullHeaders {_da .AddEndOfPageSegment ();};return nil ;};func (_ceb *Page )AddEndOfPageSegment (){_bgaf :=&_ea .Header {Type :_ea .TEndOfPage ,PageAssociation :_ceb .PageNumber };_ceb .Segments =append (_ceb .Segments ,_bgaf );};func (_af *Document )produceClassifiedPage (_aec *Page ,_ef *_ea .Header )(_faa error ){const _ecc ="p\u0072\u006f\u0064\u0075ce\u0043l\u0061\u0073\u0073\u0069\u0066i\u0065\u0064\u0050\u0061\u0067\u0065";var _dc map[int ]int ;_gef :=_af ._gb ;_cg :=[]*_ea .Header {_ef };if len (_af ._ge [_aec .PageNumber ])> 0{_dc =map[int ]int {};_efa ,_aab :=_af .addSymbolDictionary (_aec .PageNumber ,_af .Classer .UndilatedTemplates ,_af ._ge [_aec .PageNumber ],_dc ,false );if _aab !=nil {return _fbe .Wrap (_aab ,_ecc ,"");};_cg =append (_cg ,_efa );_gef +=len (_af ._ge [_aec .PageNumber ]);};_efb :=_af ._fd [_aec .PageNumber ];_ec .Log .Debug ("P\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020c\u006f\u006d\u0070\u0073: \u0025\u0076",_aec .PageNumber ,_efb );_aec .addTextRegionSegment (_cg ,_af ._eac ,_dc ,_af ._fd [_aec .PageNumber ],_af .Classer .PtaLL ,_af .Classer .UndilatedTemplates ,_af .Classer .ClassIDs ,nil ,_gbb (_gef ),len (_af ._fd [_aec .PageNumber ]));return nil ;};func (_edeg *Globals )GetSymbolDictionary ()(*_ea .Header ,error ){const _bgba ="G\u006c\u006f\u0062\u0061\u006c\u0073.\u0047\u0065\u0074\u0053\u0079\u006d\u0062\u006f\u006cD\u0069\u0063\u0074i\u006fn\u0061\u0072\u0079";if _edeg ==nil {return nil ,_fbe .Error (_bgba ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_edeg .Segments )==0{return nil ,_fbe .Error (_bgba ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};for _ ,_db :=range _edeg .Segments {if _db .Type ==_ea .TSymbolDictionary {return _db ,nil ;};};return nil ,_fbe .Error (_bgba ,"\u0067\u006c\u006fba\u006c\u0020\u0073\u0079\u006d\u0062\u006f\u006c\u0020d\u0069c\u0074i\u006fn\u0061\u0072\u0079\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");};func (_fgac *Page )collectPageStripes ()(_ecfa []_ea .Segmenter ,_dfe error ){const _dfc ="\u0063o\u006cl\u0065\u0063\u0074\u0050\u0061g\u0065\u0053t\u0072\u0069\u0070\u0065\u0073";var _bgec _ea .Segmenter ;for _ ,_acd :=range _fgac .Segments {switch _acd .Type {case 6,7,22,23,38,39,42,43:_bgec ,_dfe =_acd .GetSegmentData ();if _dfe !=nil {return nil ,_fbe .Wrap (_dfe ,_dfc ,"");};_ecfa =append (_ecfa ,_bgec );case 50:_bgec ,_dfe =_acd .GetSegmentData ();if _dfe !=nil {return nil ,_dfe ;};_cdg ,_ddd :=_bgec .(*_ea .EndOfStripe );if !_ddd {return nil ,_fbe .Errorf (_dfc ,"\u0045\u006e\u0064\u004f\u0066\u0053\u0074\u0072\u0069\u0070\u0065\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u006f\u0066\u0020\u0076\u0061l\u0069\u0064\u0020\u0074\u0079p\u0065\u003a \u0027\u0025\u0054\u0027",_bgec );};_ecfa =append (_ecfa ,_cdg );_fgac .FinalHeight =_cdg .LineNumber ();};};return _ecfa ,nil ;};func (_bagg *Page )fitsPage (_ffbe *_ea .PageInformationSegment ,_bgbb *_fb .Bitmap )bool {return _bagg .countRegions ()==1&&_ffbe .DefaultPixelValue ()==0&&_ffbe .PageBMWidth ==_bgbb .Width &&_ffbe .PageBMHeight ==_bgbb .Height ;};func (_bdag *Page )getWidth ()(int ,error ){const _ffc ="\u0067\u0065\u0074\u0057\u0069\u0064\u0074\u0068";if _bdag .FinalWidth !=0{return _bdag .FinalWidth ,nil ;};_fed :=_bdag .getPageInformationSegment ();if _fed ==nil {return 0,_fbe .Error (_ffc ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_eaff ,_adb :=_fed .GetSegmentData ();if _adb !=nil {return 0,_fbe .Wrap (_adb ,_ffc ,"");};_fgg ,_age :=_eaff .(*_ea .PageInformationSegment );if !_age {return 0,_fbe .Errorf (_ffc ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_eaff );};_bdag .FinalWidth =_fgg .PageBMWidth ;return _bdag .FinalWidth ,nil ;};func (_dfbd *Document )nextPageNumber ()uint32 {_dfbd .NumberOfPages ++;return _dfbd .NumberOfPages };func (_aee *Document )encodeEOFHeader (_eda _ba .BinaryWriter )(_aede int ,_gadc error ){_ecf :=&_ea .Header {SegmentNumber :_aee .nextSegmentNumber (),Type :_ea .TEndOfFile };if _aede ,_gadc =_ecf .Encode (_eda );_gadc !=nil {return 0,_fbe .Wrap (_gadc ,"\u0065n\u0063o\u0064\u0065\u0045\u004f\u0046\u0048\u0065\u0061\u0064\u0065\u0072","");};return _aede ,nil ;};func (_fab *Document )Encode ()(_cd []byte ,_agf error ){const _cef ="\u0044o\u0063u\u006d\u0065\u006e\u0074\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _dfb ,_baf int ;if _fab .FullHeaders {if _dfb ,_agf =_fab .encodeFileHeader (_fab ._de );_agf !=nil {return nil ,_fbe .Wrap (_agf ,_cef ,"");};};var (_cc bool ;_eca *_ea .Header ;_ede *Page ;);if _agf =_fab .completeClassifiedPages ();_agf !=nil {return nil ,_fbe .Wrap (_agf ,_cef ,"");};if _agf =_fab .produceClassifiedPages ();_agf !=nil {return nil ,_fbe .Wrap (_agf ,_cef ,"");};if _fab .GlobalSegments !=nil {for _ ,_eca =range _fab .GlobalSegments .Segments {if _agf =_fab .encodeSegment (_eca ,&_dfb );_agf !=nil {return nil ,_fbe .Wrap (_agf ,_cef ,"");};};};for _bdb :=1;_bdb <=int (_fab .NumberOfPages );_bdb ++{if _ede ,_cc =_fab .Pages [_bdb ];!_cc {return nil ,_fbe .Errorf (_cef ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_bdb );};for _ ,_eca =range _ede .Segments {if _agf =_fab .encodeSegment (_eca ,&_dfb );_agf !=nil {return nil ,_fbe .Wrap (_agf ,_cef ,"");};};};if _fab .FullHeaders {if _baf ,_agf =_fab .encodeEOFHeader (_fab ._de );_agf !=nil {return nil ,_fbe .Wrap (_agf ,_cef ,"");};_dfb +=_baf ;};_cd =_fab ._de .Data ();if len (_cd )!=_dfb {_ec .Log .Debug ("\u0042\u0079\u0074\u0065\u0073 \u0077\u0072\u0069\u0074\u0074\u0065\u006e \u0028\u006e\u0029\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0074\u0068\u0065\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u0020\u006f\u0066\u0020t\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0065\u006e\u0063\u006fd\u0065\u0064\u003a\u0020\u0027\u0025d\u0027",_dfb ,len (_cd ));};return _cd ,nil ;};func (_cefe *Page )getCombinationOperator (_fbge *_ea .PageInformationSegment ,_ged _fb .CombinationOperator )_fb .CombinationOperator {if _fbge .CombinationOperatorOverrideAllowed (){return _ged ;};return _fbge .CombinationOperator ();};func (_gdc *Document )parseFileHeader ()error {const _bga ="\u0070a\u0072s\u0065\u0046\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_ ,_gbd :=_gdc .InputStream .Seek (8,_eg .SeekStart );if _gbd !=nil {return _fbe .Wrap (_gbd ,_bga ,"\u0069\u0064");};_ ,_gbd =_gdc .InputStream .ReadBits (5);if _gbd !=nil {return _fbe .Wrap (_gbd ,_bga ,"\u0072\u0065\u0073\u0065\u0072\u0076\u0065\u0064\u0020\u0062\u0069\u0074\u0073");};_dcc ,_gbd :=_gdc .InputStream .ReadBit ();if _gbd !=nil {return _fbe .Wrap (_gbd ,_bga ,"\u0065x\u0074e\u006e\u0064\u0065\u0064\u0020t\u0065\u006dp\u006c\u0061\u0074\u0065\u0073");};if _dcc ==1{_gdc .GBUseExtTemplate =true ;};_dcc ,_gbd =_gdc .InputStream .ReadBit ();if _gbd !=nil {return _fbe .Wrap (_gbd ,_bga ,"\u0075\u006e\u006b\u006eow\u006e\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};if _dcc !=1{_gdc .NumberOfPagesUnknown =false ;};_dcc ,_gbd =_gdc .InputStream .ReadBit ();if _gbd !=nil {return _fbe .Wrap (_gbd ,_bga ,"\u006f\u0072\u0067\u0061\u006e\u0069\u007a\u0061\u0074\u0069\u006f\u006e \u0074\u0079\u0070\u0065");};_gdc .OrganizationType =_ea .OrganizationType (_dcc );if !_gdc .NumberOfPagesUnknown {_gdc .NumberOfPages ,_gbd =_gdc .InputStream .ReadUint32 ();if _gbd !=nil {return _fbe .Wrap (_gbd ,_bga ,"\u006eu\u006db\u0065\u0072\u0020\u006f\u0066\u0020\u0070\u0061\u0067\u0065\u0073");};_gdc ._gd =13;};return nil ;};func (_df *Document )completeClassifiedPages ()(_deb error ){const _gg ="\u0063\u006f\u006dpl\u0065\u0074\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067\u0065\u0073";if _df .Classer ==nil {return nil ;};_df ._a =make ([]int ,_df .Classer .UndilatedTemplates .Size ());for _fdg :=0;_fdg < _df .Classer .ClassIDs .Size ();_fdg ++{_ab ,_ed :=_df .Classer .ClassIDs .Get (_fdg );if _ed !=nil {return _fbe .Wrapf (_ed ,_gg ,"\u0063\u006c\u0061\u0073s \u0077\u0069\u0074\u0068\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027",_fdg );};_df ._a [_ab ]++;};var _fg []int ;for _ca :=0;_ca < _df .Classer .UndilatedTemplates .Size ();_ca ++{if _df .NumberOfPages ==1||_df ._a [_ca ]> 1{_fg =append (_fg ,_ca );};};var (_ee *Page ;_ag bool ;);for _bc ,_agg :=range *_df .Classer .ComponentPageNumbers {if _ee ,_ag =_df .Pages [_agg ];!_ag {return _fbe .Errorf (_gg ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_bc );};if _ee .EncodingMethod ==GenericEM {_ec .Log .Error ("\u0047\u0065\u006e\u0065\u0072\u0069c\u0020\u0070\u0061g\u0065\u0020\u0077i\u0074\u0068\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020ma\u0070\u0070\u0065\u0064\u0020\u0061\u0073\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0020\u0070\u0061\u0067\u0065",_bc );continue ;};_df ._fd [_agg ]=append (_df ._fd [_agg ],_bc );_cf ,_aba :=_df .Classer .ClassIDs .Get (_bc );if _aba !=nil {return _fbe .Wrapf (_aba ,_gg ,"\u006e\u006f\u0020\u0073uc\u0068\u0020\u0063\u006c\u0061\u0073\u0073\u0049\u0044\u003a\u0020\u0025\u0064",_bc );};if _df ._a [_cf ]==1&&_df .NumberOfPages !=1{_cff :=append (_df ._ge [_agg ],_cf );_df ._ge [_agg ]=_cff ;};};if _deb =_df .Classer .ComputeLLCorners ();_deb !=nil {return _fbe .Wrap (_deb ,_gg ,"");};if _ ,_deb =_df .addSymbolDictionary (0,_df .Classer .UndilatedTemplates ,_fg ,_df ._eac ,false );_deb !=nil {return _fbe .Wrap (_deb ,_gg ,"");};return nil ;};func (_cbcd *Page )lastSegmentNumber ()(_ecd uint32 ,_fdgg error ){const _gaa ="\u006c\u0061\u0073\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u004eu\u006d\u0062\u0065\u0072";if len (_cbcd .Segments )==0{return _ecd ,_fbe .Errorf (_gaa ,"\u006e\u006f\u0020se\u0067\u006d\u0065\u006e\u0074\u0073\u0020\u0066\u006fu\u006ed\u0020i\u006e \u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027",_cbcd .PageNumber );};return _cbcd .Segments [len (_cbcd .Segments )-1].SegmentNumber ,nil ;};func (_cfa *Page )GetWidth ()(int ,error ){return _cfa .getWidth ()};func (_gf *Document )AddGenericPage (bm *_fb .Bitmap ,duplicateLineRemoval bool )(_aa error ){const _fe ="\u0044\u006f\u0063um\u0065\u006e\u0074\u002e\u0041\u0064\u0064\u0047\u0065\u006e\u0065\u0072\u0069\u0063\u0050\u0061\u0067\u0065";if !_gf .FullHeaders &&_gf .NumberOfPages !=0{return _fbe .Error (_fe ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");};_ad :=&Page {Segments :[]*_ea .Header {},Bitmap :bm ,Document :_gf ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,IsLossless :true };_ad .PageNumber =int (_gf .nextPageNumber ());_gf .Pages [_ad .PageNumber ]=_ad ;_ad .AddPageInformationSegment ();if _aa =_ad .AddGenericRegion (bm ,0,0,0,_ea .TImmediateGenericRegion ,duplicateLineRemoval );_aa !=nil {return _fbe .Wrap (_aa ,_fe ,"");};if _gf .FullHeaders {_ad .AddEndOfPageSegment ();};return nil ;};func (_aeg *Document )nextSegmentNumber ()uint32 {_be :=_aeg .CurrentSegmentNumber ;_aeg .CurrentSegmentNumber ++;return _be ;};func (_agfe *Page )getPageInformationSegment ()*_ea .Header {for _ ,_bdg :=range _agfe .Segments {if _bdg .Type ==_ea .TPageInformation {return _bdg ;};};_ec .Log .Debug ("\u0050\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066o\u0072\u0020\u0070\u0061\u0067\u0065\u003a\u0020%\u0073\u002e",_agfe );return nil ;};func (_cad *Document )addSymbolDictionary (_dg int ,_eb *_fb .Bitmaps ,_cag []int ,_bcc map[int ]int ,_daa bool )(*_ea .Header ,error ){const _add ="\u0061\u0064\u0064\u0053ym\u0062\u006f\u006c\u0044\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079";_efd :=&_ea .SymbolDictionary {};if _ga :=_efd .InitEncode (_eb ,_cag ,_bcc ,_daa );_ga !=nil {return nil ,_ga ;};_dag :=&_ea .Header {Type :_ea .TSymbolDictionary ,PageAssociation :_dg ,SegmentData :_efd };if _dg ==0{if _cad .GlobalSegments ==nil {_cad .GlobalSegments =&Globals {};};_cad .GlobalSegments .AddSegment (_dag );return _dag ,nil ;};_dae ,_cfb :=_cad .Pages [_dg ];if !_cfb {return nil ,_fbe .Errorf (_add ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_dg );};var (_dd int ;_dgg *_ea .Header ;);for _dd ,_dgg =range _dae .Segments {if _dgg .Type ==_ea .TPageInformation {break ;};};_dd ++;_dae .Segments =append (_dae .Segments ,nil );copy (_dae .Segments [_dd +1:],_dae .Segments [_dd :]);_dae .Segments [_dd ]=_dag ;return _dag ,nil ;};type Document struct{Pages map[int ]*Page ;NumberOfPagesUnknown bool ;NumberOfPages uint32 ;GBUseExtTemplate bool ;InputStream _ba .StreamReader ;GlobalSegments *Globals ;OrganizationType _ea .OrganizationType ;Classer *_ff .Classer ;XRes ,YRes int ;FullHeaders bool ;CurrentSegmentNumber uint32 ;AverageTemplates *_fb .Bitmaps ;BaseIndexes []int ;Refinement bool ;RefineLevel int ;_gd uint8 ;_de *_ba .BufferedWriter ;EncodeGlobals bool ;_gb int ;_ge map[int ][]int ;_fd map[int ][]int ;_a []int ;_eac map[int ]int ;};func (_ccb *Page )GetResolutionX ()(int ,error ){return _ccb .getResolutionX ()};func (_bec *Globals )GetSegment (segmentNumber int )(*_ea .Header ,error ){const _eed ="\u0047l\u006fb\u0061\u006c\u0073\u002e\u0047e\u0074\u0053e\u0067\u006d\u0065\u006e\u0074";if _bec ==nil {return nil ,_fbe .Error (_eed ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_bec .Segments )==0{return nil ,_fbe .Error (_eed ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};var _fee *_ea .Header ;for _ ,_fee =range _bec .Segments {if _fee .SegmentNumber ==uint32 (segmentNumber ){break ;};};if _fee ==nil {return nil ,_fbe .Error (_eed ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};return _fee ,nil ;};func (_bgda *Page )AddPageInformationSegment (){_ggd :=&_ea .PageInformationSegment {PageBMWidth :_bgda .FinalWidth ,PageBMHeight :_bgda .FinalHeight ,ResolutionX :_bgda .ResolutionX ,ResolutionY :_bgda .ResolutionY ,IsLossless :_bgda .IsLossless };_cffe :=&_ea .Header {PageAssociation :_bgda .PageNumber ,SegmentDataLength :uint64 (_ggd .Size ()),SegmentData :_ggd ,Type :_ea .TPageInformation };_bgda .Segments =append (_bgda .Segments ,_cffe );};func (_afg *Document )mapData ()error {const _gfg ="\u006da\u0070\u0044\u0061\u0074\u0061";var (_dfa []*_ea .Header ;_bda int64 ;_egf _ea .Type ;);_bb ,_gag :=_afg .isFileHeaderPresent ();if _gag !=nil {return _fbe .Wrap (_gag ,_gfg ,"");};if _bb {if _gag =_afg .parseFileHeader ();_gag !=nil {return _fbe .Wrap (_gag ,_gfg ,"");};_bda +=int64 (_afg ._gd );_afg .FullHeaders =true ;};var (_gge *Page ;_cffg bool ;);for _egf !=51&&!_cffg {_eba ,_abe :=_ea .NewHeader (_afg ,_afg .InputStream ,_bda ,_afg .OrganizationType );if _abe !=nil {return _fbe .Wrap (_abe ,_gfg ,"");};_ec .Log .Trace ("\u0044\u0065c\u006f\u0064\u0069\u006eg\u0020\u0073e\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u0075m\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c\u0020\u0054\u0079\u0070e\u003a\u0020\u0025\u0073",_eba .SegmentNumber ,_eba .Type );_egf =_eba .Type ;if _egf !=_ea .TEndOfFile {if _eba .PageAssociation !=0{_gge =_afg .Pages [_eba .PageAssociation ];if _gge ==nil {_gge =_cgg (_afg ,_eba .PageAssociation );_afg .Pages [_eba .PageAssociation ]=_gge ;if _afg .NumberOfPagesUnknown {_afg .NumberOfPages ++;};};_gge .Segments =append (_gge .Segments ,_eba );}else {_afg .GlobalSegments .AddSegment (_eba );};};_dfa =append (_dfa ,_eba );_bda =_afg .InputStream .StreamPosition ();if _afg .OrganizationType ==_ea .OSequential {_bda +=int64 (_eba .SegmentDataLength );};_cffg ,_abe =_afg .reachedEOF (_bda );if _abe !=nil {_ec .Log .Debug ("\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u0072\u0065\u0061\u0063h\u0065\u0064\u0020\u0045\u004f\u0046\u0020\u0077\u0069\u0074\u0068\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0076",_abe );return _fbe .Wrap (_abe ,_gfg ,"");};};_afg .determineRandomDataOffsets (_dfa ,uint64 (_bda ));return nil ;};func (_dgf *Page )GetHeight ()(int ,error ){return _dgf .getHeight ()};func (_bbb *Page )getHeight ()(int ,error ){const _fgd ="\u0067e\u0074\u0048\u0065\u0069\u0067\u0068t";if _bbb .FinalHeight !=0{return _bbb .FinalHeight ,nil ;};_bdbf :=_bbb .getPageInformationSegment ();if _bdbf ==nil {return 0,_fbe .Error (_fgd ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_gafa ,_eef :=_bdbf .GetSegmentData ();if _eef !=nil {return 0,_fbe .Wrap (_eef ,_fgd ,"");};_cba ,_dfga :=_gafa .(*_ea .PageInformationSegment );if !_dfga {return 0,_fbe .Errorf (_fgd ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_gafa );};if _cba .PageBMHeight ==_b .MaxInt32 {_ ,_eef =_bbb .GetBitmap ();if _eef !=nil {return 0,_fbe .Wrap (_eef ,_fgd ,"");};}else {_bbb .FinalHeight =_cba .PageBMHeight ;};return _bbb .FinalHeight ,nil ;};type EncodingMethod int ;func (_gfc *Document )GetNumberOfPages ()(uint32 ,error ){if _gfc .NumberOfPagesUnknown ||_gfc .NumberOfPages ==0{if len (_gfc .Pages )==0{if _gfe :=_gfc .mapData ();_gfe !=nil {return 0,_fbe .Wrap (_gfe ,"\u0044o\u0063\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074N\u0075m\u0062e\u0072\u004f\u0066\u0050\u0061\u0067\u0065s","");};};return uint32 (len (_gfc .Pages )),nil ;};return _gfc .NumberOfPages ,nil ;};