//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_d "errors";_g "fmt";_b "github.com/unidoc/unipdf/v3/common";_e "github.com/unidoc/unipdf/v3/core";);func (_cd *Catalog )SetMarkInfo (mi _e .PdfObject ){_edf :=_e .MakeIndirectObject (mi );_cd .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_edf );
_cd ._db .Objects =append (_cd ._db .Objects ,_edf );};type Image struct{Name string ;Width int ;Height int ;Colorspace _e .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_e .PdfObjectStream ;};func (_fgfd Page )GetResources ()(*_e .PdfObjectDictionary ,bool ){return _e .GetDict (_fgfd .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};type Document struct{ID [2]string ;Version _e .Version ;Objects []_e .PdfObject ;Info _e .PdfObject ;Crypt *_e .PdfCrypt ;UseHashBasedID bool ;};type Content struct{Stream *_e .PdfObjectStream ;_edcf int ;_gfda Page ;};func (_gc *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_cda :=_gc .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _cda ==nil {return nil ,false ;};_fgf ,_cag :=_e .GetIndirect (_cda );if !_cag {return nil ,false ;};_ce ,_efe :=_e .GetArray (_fgf .PdfObject );if !_efe {return nil ,false ;};return &OutputIntents {_cdd :_fgf ,_fcb :_ce ,_ea :_gc ._db },true ;};func (_bba Page )FindXObjectImages ()([]*Image ,error ){_fce ,_cbe :=_bba .GetResourcesXObject ();
if !_cbe {return nil ,nil ;};var _dga []*Image ;var _daa error ;_edfe :=map[*_e .PdfObjectStream ]int {};_aea :=map[*_e .PdfObjectStream ]struct{}{};var _fcgd int ;for _ ,_baf :=range _fce .Keys (){_abae ,_dge :=_e .GetStream (_fce .Get (_baf ));if !_dge {continue ;
};if _ ,_baff :=_edfe [_abae ];_baff {continue ;};_fgb ,_af :=_e .GetName (_abae .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_af ||_fgb .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_bec :=Image {BitsPerComponent :8,Stream :_abae ,Name :string (_baf )};
if _bec .Colorspace ,_daa =_eg (_abae .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_daa !=nil {_b .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_daa );
continue ;};if _df ,_ggb :=_e .GetIntVal (_abae .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_ggb {_bec .BitsPerComponent =_df ;};if _aae ,_acg :=_e .GetIntVal (_abae .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_acg {_bec .Width =_aae ;};if _gca ,_cdaf :=_e .GetIntVal (_abae .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_cdaf {_bec .Height =_gca ;};if _gbcf ,_dfe :=_e .GetStream (_abae .Get ("\u0053\u004d\u0061s\u006b"));_dfe {_bec .SMask =&ImageSMask {Image :&_bec ,Stream :_gbcf };
_aea [_gbcf ]=struct{}{};};switch _bec .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_bec .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_bec .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_bec .ColorComponents =4;
default:_bec .ColorComponents =-1;};_edfe [_abae ]=_fcgd ;_dga =append (_dga ,&_bec );_fcgd ++;};var _agd []int ;for _ ,_gef :=range _dga {if _gef .SMask !=nil {_dbe ,_dba :=_edfe [_gef .SMask .Stream ];if _dba {_agd =append (_agd ,_dbe );};};};_eee :=make ([]*Image ,len (_dga )-len (_agd ));
_fcgd =0;_gae :for _fea ,_dac :=range _dga {for _ ,_dff :=range _agd {if _fea ==_dff {continue _gae ;};};_eee [_fcgd ]=_dac ;_fcgd ++;};return _dga ,nil ;};func (_cef *Document )AddIndirectObject (indirect *_e .PdfIndirectObject ){for _ ,_dde :=range _cef .Objects {if _dde ==indirect {return ;
};};_cef .Objects =append (_cef .Objects ,indirect );};type OutputIntent struct{Object *_e .PdfObjectDictionary ;};func (_fgd *OutputIntents )Get (i int )(OutputIntent ,bool ){if _fgd ._fcb ==nil {return OutputIntent {},false ;};if i >=_fgd ._fcb .Len (){return OutputIntent {},false ;
};_aac :=_fgd ._fcb .Get (i );_gbc ,_ec :=_e .GetIndirect (_aac );if !_ec {_da ,_ee :=_e .GetDict (_aac );return OutputIntent {Object :_da },_ee ;};_bc ,_edg :=_e .GetDict (_gbc .PdfObject );return OutputIntent {Object :_bc },_edg ;};func (_fcg *Document )AddStream (stream *_e .PdfObjectStream ){for _ ,_acb :=range _fcg .Objects {if _acb ==stream {return ;
};};_fcg .Objects =append (_fcg .Objects ,stream );};func (_a *Catalog )GetPages ()([]Page ,bool ){_ed ,_ef :=_e .GetDict (_a .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_ef {return nil ,false ;};_ge ,_ag :=_e .GetArray (_ed .Get ("\u004b\u0069\u0064\u0073"));
if !_ag {return nil ,false ;};_bf :=make ([]Page ,_ge .Len ());for _ba ,_gd :=range _ge .Elements (){_bb ,_dd :=_e .GetDict (_gd );if !_dd {continue ;};_bf [_ba ]=Page {Object :_bb ,_dbcb :_ba +1,_bgg :_a ._db };};return _bf ,true ;};func (_cg *OutputIntents )Len ()int {return _cg ._fcb .Len ()};
func (_f *Catalog )SetVersion (){_f .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_e .MakeName (_g .Sprintf ("\u0025\u0064\u002e%\u0064",_f ._db .Version .Major ,_f ._db .Version .Minor )));};type Page struct{_dbcb int ;Object *_e .PdfObjectDictionary ;
_bgg *Document ;};func (_fad Page )FindXObjectForms ()[]*_e .PdfObjectStream {_ceg ,_aeb :=_fad .GetResourcesXObject ();if !_aeb {return nil ;};_cc :=map[*_e .PdfObjectStream ]struct{}{};var _cbg func (_eae *_e .PdfObjectDictionary ,_bcg map[*_e .PdfObjectStream ]struct{});
_cbg =func (_bga *_e .PdfObjectDictionary ,_bac map[*_e .PdfObjectStream ]struct{}){for _ ,_daf :=range _bga .Keys (){_aec ,_dgf :=_e .GetStream (_bga .Get (_daf ));if !_dgf {continue ;};if _ ,_gaa :=_bac [_aec ];_gaa {continue ;};_caa ,_ccd :=_e .GetName (_aec .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_ccd ||_caa .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_bac [_aec ]=struct{}{};_eacd ,_ccd :=_e .GetDict (_aec .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_ccd {continue ;};_bca ,_dbec :=_e .GetDict (_eacd .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _dbec {_cbg (_bca ,_bac );};};};_cbg (_ceg ,_cc );var _gbca []*_e .PdfObjectStream ;for _bgf :=range _cc {_gbca =append (_gbca ,_bgf );};return _gbca ;};func (_dcf Page )GetContents ()([]Content ,bool ){_dab ,_eaf :=_e .GetArray (_dcf .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_eaf {_eb ,_aba :=_e .GetStream (_dcf .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_aba {return nil ,false ;};return []Content {{Stream :_eb ,_gfda :_dcf ,_edcf :0}},true ;};_dbb :=make ([]Content ,_dab .Len ());for _de ,_dabe :=range _dab .Elements (){_fb ,_efb :=_e .GetStream (_dabe );
if !_efb {continue ;};_dbb [_de ]=Content {Stream :_fb ,_gfda :_dcf ,_edcf :_de };};return _dbb ,true ;};func (_ff *Catalog )HasMetadata ()bool {_aa :=_ff .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");return _aa !=nil ;};type Catalog struct{Object *_e .PdfObjectDictionary ;
_db *Document ;};func (_fg *Catalog )GetMetadata ()(*_e .PdfObjectStream ,bool ){_bg ,_cb :=_e .GetStream (_fg .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));return _bg ,_cb ;};func (_bea Page )GetResourcesXObject ()(*_e .PdfObjectDictionary ,bool ){_bfe ,_edcb :=_bea .GetResources ();
if !_edcb {return nil ,false ;};return _e .GetDict (_bfe .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_dbc *OutputIntents )Add (oi _e .PdfObject )error {_aaa ,_be :=oi .(*_e .PdfObjectDictionary );if !_be {return _d .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _edc ,_gcb :=_e .GetStream (_aaa .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_gcb {_dbc ._ea .Objects =append (_dbc ._ea .Objects ,_edc );};_adg ,_cgd :=oi .(*_e .PdfIndirectObject );
if !_cgd {_adg =_e .MakeIndirectObject (oi );};if _dbc ._fcb ==nil {_dbc ._fcb =_e .MakeArray (_adg );}else {_dbc ._fcb .Append (_adg );};_dbc ._ea .Objects =append (_dbc ._ea .Objects ,_adg );return nil ;};func (_bfg *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_ea :_bfg ._db }};
func (_gb *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _bge :=_gb .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");_bge !=nil {for _ddg ,_fc :=range _gb ._db .Objects {if _fc ==_bge {if outputIntents ._cdd ==_bge {return ;
};_gb ._db .Objects =append (_gb ._db .Objects [:_ddg ],_gb ._db .Objects [_ddg +1:]...);break ;};};};_gbb :=outputIntents ._cdd ;if _gbb ==nil {_gbb =_e .MakeIndirectObject (outputIntents ._fcb );};_gb .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_gbb );
_gb ._db .Objects =append (_gb ._db .Objects ,_gbb );};func (_cf *Page )Number ()int {return _cf ._dbcb };func (_gde *Catalog )SetMetadata (data []byte )error {_ad ,_ga :=_e .MakeStream (data ,nil );if _ga !=nil {return _ga ;};_ad .Set ("\u0054\u0079\u0070\u0065",_e .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
_ad .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_e .MakeName ("\u0058\u004d\u004c"));_gde .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_ad );_gde ._db .Objects =append (_gde ._db .Objects ,_ad );return nil ;};func (_adb *Document )FindCatalog ()(*Catalog ,bool ){var _gcf *_e .PdfObjectDictionary ;
for _ ,_gad :=range _adb .Objects {_fa ,_cbc :=_e .GetDict (_gad );if !_cbc {continue ;};if _bcb ,_aag :=_e .GetName (_fa .Get ("\u0054\u0079\u0070\u0065"));_aag &&*_bcb =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_gcf =_fa ;break ;};};if _gcf ==nil {return nil ,false ;
};return &Catalog {Object :_gcf ,_db :_adb },true ;};func (_efa *Catalog )GetMarkInfo ()(*_e .PdfObjectDictionary ,bool ){_dc ,_ca :=_e .GetDict (_efa .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));return _dc ,_ca ;};func (_dag *Content )SetData (data []byte )error {_dage ,_eeef :=_e .MakeStream (data ,_e .NewFlateEncoder ());
if _eeef !=nil {return _eeef ;};_fga ,_dce :=_e .GetArray (_dag ._gfda .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_dce &&_dag ._edcf ==0{_dag ._gfda .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_dage );}else {if _eeef =_fga .Set (_dag ._edcf ,_dage );
_eeef !=nil {return _eeef ;};};_dag ._gfda ._bgg .Objects =append (_dag ._gfda ._bgg .Objects ,_dage );return nil ;};func (_ae *Document )GetPages ()([]Page ,bool ){_ac ,_fe :=_ae .FindCatalog ();if !_fe {return nil ,false ;};return _ac .GetPages ();};
func (_bafe Content )GetData ()([]byte ,error ){_gcaa ,_ded :=_e .NewEncoderFromStream (_bafe .Stream );if _ded !=nil {return nil ,_ded ;};_cdaa ,_ded :=_gcaa .DecodeStream (_bafe .Stream );if _ded !=nil {return nil ,_ded ;};return _cdaa ,nil ;};type OutputIntents struct{_fcb *_e .PdfObjectArray ;
_ea *Document ;_cdd *_e .PdfIndirectObject ;};func _eg (_gf _e .PdfObject )(_e .PdfObjectName ,error ){var _gfd *_e .PdfObjectName ;var _ace *_e .PdfObjectArray ;if _eac ,_eeb :=_gf .(*_e .PdfIndirectObject );_eeb {if _ab ,_geg :=_eac .PdfObject .(*_e .PdfObjectArray );
_geg {_ace =_ab ;}else if _dg ,_acc :=_eac .PdfObject .(*_e .PdfObjectName );_acc {_gfd =_dg ;};}else if _ada ,_aed :=_gf .(*_e .PdfObjectArray );_aed {_ace =_ada ;}else if _ddef ,_caf :=_gf .(*_e .PdfObjectName );_caf {_gfd =_ddef ;};if _gfd !=nil {switch *_gfd {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_gfd ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_gfd ,nil ;};};if _ace !=nil &&_ace .Len ()> 0{if _bef ,_gdf :=_ace .Get (0).(*_e .PdfObjectName );_gdf {switch *_bef {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _ace .Len ()==1{return *_bef ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_bef ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_bef ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_bef ,nil ;};};};return "",nil ;};type ImageSMask struct{Image *Image ;Stream *_e .PdfObjectStream ;};