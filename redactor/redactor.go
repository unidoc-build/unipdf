//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package redactor ;import (_f "errors";_e "fmt";_eg "github.com/unidoc/unipdf/v3/common";_b "github.com/unidoc/unipdf/v3/contentstream";_g "github.com/unidoc/unipdf/v3/core";_fb "github.com/unidoc/unipdf/v3/creator";_ca "github.com/unidoc/unipdf/v3/extractor";
_fd "github.com/unidoc/unipdf/v3/model";_a "io";_fa "regexp";_af "sort";_d "strings";);func _dc (_ecdb *_fd .PdfFont ,_cfa _ca .TextMark )float64 {_dga :=0.001;_bfg :=_cfa .Th /100;if _ecdb .Subtype ()=="\u0054\u0079\u0070e\u0033"{_dga =1;};_deg ,_ece :=_ecdb .GetRuneMetrics (' ');
if !_ece {_deg ,_ece =_ecdb .GetCharMetrics (32);};if !_ece {_deg ,_ =_fd .DefaultFont ().GetRuneMetrics (' ');};_cgg :=_dga *((_deg .Wx *_cfa .FontSize +_cfa .Tc +_cfa .Tw )/_bfg );return _cgg ;};func _eed (_dbg []localSpanMarks )(map[string ][]localSpanMarks ,[]string ){_bbd :=make (map[string ][]localSpanMarks );
_fca :=[]string {};for _ ,_aag :=range _dbg {_cef :=_aag ._aae ;if _beg ,_dbdf :=_bbd [_cef ];_dbdf {_bbd [_cef ]=append (_beg ,_aag );}else {_bbd [_cef ]=[]localSpanMarks {_aag };_fca =append (_fca ,_cef );};};return _bbd ,_fca ;};func _ea (_bc *_b .ContentStreamOperation ,_bca _g .PdfObject ,_dbf []localSpanMarks )error {_gcg ,_aac :=_g .GetArray (_bc .Params [0]);
_gf :=[]_g .PdfObject {};if !_aac {_eg .Log .Debug ("\u0045\u0052\u0052OR\u003a\u0020\u0054\u004a\u0020\u006f\u0070\u003d\u0025s\u0020G\u0065t\u0041r\u0072\u0061\u0079\u0056\u0061\u006c\u0020\u0066\u0061\u0069\u006c\u0065\u0064",_bc );return _e .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_bc );
};_gg ,_bg :=_eed (_dbf );if len (_bg )==1{_ceb :=_bg [0];_agf :=_gg [_ceb ];if len (_agf )==1{_fe :=_agf [0];_gdd :=_fe ._eaad ;_bdd :=_egc (_gdd );_dgga ,_daa :=_agae (_bca ,_bdd );if _daa !=nil {return _daa ;};_afa ,_daa :=_dff (_fe ,_gdd ,_bdd ,_dgga ,_ceb );
if _daa !=nil {return _daa ;};for _ ,_cb :=range _gcg .Elements (){if _cb ==_bca {_gf =append (_gf ,_afa ...);}else {_gf =append (_gf ,_cb );};};}else {_ga :=_agf [0]._eaad ;_aea :=_egc (_ga );_ccb ,_bgf :=_agae (_bca ,_aea );if _bgf !=nil {return _bgf ;
};_geg ,_bgf :=_ba (_ccb ,_agf );if _bgf !=nil {return _bgf ;};_cff :=_abf (_geg );_cbe :=_gegbc (_ccb ,_cff ,_aea );for _ ,_gad :=range _gcg .Elements (){if _gad ==_bca {_gf =append (_gf ,_cbe ...);}else {_gf =append (_gf ,_gad );};};};_bc .Params [0]=_g .MakeArray (_gf ...);
}else if len (_bg )> 1{_bb :=_dbf [0];_bee :=_bb ._eaad ;_ ,_cce :=_bec (_bee );_bcf :=_bee .Elements ()[_cce ];_abe :=_bcf .Font ;_dbd ,_ecf :=_agae (_bca ,_abe );if _ecf !=nil {return _ecf ;};_dgd ,_ecf :=_ba (_dbd ,_dbf );if _ecf !=nil {return _ecf ;
};_cedd :=_abf (_dgd );_egb :=_gegbc (_dbd ,_cedd ,_abe );for _ ,_ddc :=range _gcg .Elements (){if _ddc ==_bca {_gf =append (_gf ,_egb ...);}else {_gf =append (_gf ,_ddc );};};_bc .Params [0]=_g .MakeArray (_gf ...);};return nil ;};func _bdf (_gcf string ,_fga *_fd .PdfFont )[]byte {_cabf ,_fge :=_fga .StringToCharcodeBytes (_gcf );
if _fge !=0{_eg .Log .Debug ("\u0057\u0041\u0052\u004e\u003a\u0020\u0073\u006fm\u0065\u0020\u0072un\u0065\u0073\u0020\u0063\u006f\u0075l\u0064\u0020\u006e\u006f\u0074\u0020\u0062\u0065\u0020\u0065\u006e\u0063\u006f\u0064\u0065d\u002e\u000a\u0009\u0025\u0073\u0020\u002d\u003e \u0025\u0076",_gcf ,_cabf );
};return _cabf ;};func _agae (_adgf _g .PdfObject ,_fbe *_fd .PdfFont )(string ,error ){_caba ,_adc :=_g .GetStringBytes (_adgf );if !_adc {return "",_g .ErrTypeError ;};_ecc :=_fbe .BytesToCharcodes (_caba );_dge ,_bbgb ,_gcb :=_fbe .CharcodesToStrings (_ecc );
if _gcb > 0{_eg .Log .Debug ("\u0072\u0065nd\u0065\u0072\u0054e\u0078\u0074\u003a\u0020num\u0043ha\u0072\u0073\u003d\u0025\u0064\u0020\u006eum\u004d\u0069\u0073\u0073\u0065\u0073\u003d%\u0064",_bbgb ,_gcb );};_bega :=_d .Join (_dge ,"");return _bega ,nil ;
};func _adcf (_gfgf *_ca .TextMarkArray )string {_cfbg :="";for _ ,_ffg :=range _gfgf .Elements (){_cfbg +=_ffg .Text ;};return _cfbg ;};func _dege (_beae ,_dgag ,_bgc float64 )float64 {_bgc =_bgc /100;_afcc :=(-1000*_beae )/(_dgag *_bgc );return _afcc ;
};func _gggg (_beafb []*targetMap ){for _efc ,_dcfc :=range _beafb {for _bbdc ,_fddc :=range _beafb {if _efc !=_bbdc {_aaa ,_gegg :=_ggd (*_dcfc ,*_fddc );if _aaa {_beec (_fddc ,_gegg );};};};};};func _abf (_gef []placeHolders )[]replacement {_ege :=[]replacement {};
for _ ,_bfd :=range _gef {_dgaf :=_bfd ._gc ;_cbf :=_bfd ._ec ;_dbde :=_bfd ._ag ;for _ ,_bfc :=range _dgaf {_cfd :=replacement {_ae :_cbf ,_afc :_dbde ,_ef :_bfc };_ege =append (_ege ,_cfd );};};_af .Slice (_ege ,func (_bbac ,_cbc int )bool {return _ege [_bbac ]._ef < _ege [_cbc ]._ef });
return _ege ;};func _gfdf (_dcfd *_ca .TextMarkArray )[]*_ca .TextMarkArray {_cefe :=_dcfd .Elements ();_bffd :=len (_cefe );var _gacf _g .PdfObject ;_afg :=[]*_ca .TextMarkArray {};_fef :=&_ca .TextMarkArray {};_adf :=-1;for _ccg ,_gdfg :=range _cefe {_ccd :=_gdfg .DirectObject ;
_adf =_gdfg .Index ;if _ccd ==nil {_ecgg :=_abd (_dcfd ,_ccg ,_adf );if _gacf !=nil {if _ecgg ==-1||_ecgg > _ccg {_afg =append (_afg ,_fef );_fef =&_ca .TextMarkArray {};};};}else if _ccd !=nil &&_gacf ==nil {if _adf ==0&&_ccg > 0{_afg =append (_afg ,_fef );
_fef =&_ca .TextMarkArray {};};}else if _ccd !=nil &&_gacf !=nil {if _ccd !=_gacf {_afg =append (_afg ,_fef );_fef =&_ca .TextMarkArray {};};};_gacf =_ccd ;_fef .Append (_gdfg );if _ccg ==(_bffd -1){_afg =append (_afg ,_fef );};};return _afg ;};

// RectangleProps defines properties of the redaction rectangle to be drawn.
type RectangleProps struct{FillColor _fb .Color ;BorderWidth float64 ;FillOpacity float64 ;};func _ccbc (_bdc *_b .ContentStreamOperation ,_dgdg _g .PdfObject ,_bfe []localSpanMarks )error {var _fdc *_g .PdfObjectArray ;_dba ,_add :=_eed (_bfe );if len (_add )==1{_eaa :=_add [0];
_fgf :=_dba [_eaa ];if len (_fgf )==1{_ecb :=_fgf [0];_ecg :=_ecb ._eaad ;_fbc :=_egc (_ecg );_ed ,_aee :=_agae (_dgdg ,_fbc );if _aee !=nil {return _aee ;};_agb ,_aee :=_dff (_ecb ,_ecg ,_fbc ,_ed ,_eaa );if _aee !=nil {return _aee ;};_fdc =_g .MakeArray (_agb ...);
}else {_dbe :=_fgf [0]._eaad ;_ddf :=_egc (_dbe );_egcf ,_bgd :=_agae (_dgdg ,_ddf );if _bgd !=nil {return _bgd ;};_ecgd ,_bgd :=_ba (_egcf ,_fgf );if _bgd !=nil {return _bgd ;};_cbg :=_abf (_ecgd );_egd :=_gegbc (_egcf ,_cbg ,_ddf );_fdc =_g .MakeArray (_egd ...);
};}else if len (_add )> 1{_afcb :=_bfe [0];_aga :=_afcb ._eaad ;_ ,_cfb :=_bec (_aga );_gga :=_aga .Elements ()[_cfb ];_bda :=_gga .Font ;_fbca ,_dgb :=_agae (_dgdg ,_bda );if _dgb !=nil {return _dgb ;};_ff ,_dgb :=_ba (_fbca ,_bfe );if _dgb !=nil {return _dgb ;
};_gag :=_abf (_ff );_dbfg :=_gegbc (_fbca ,_gag ,_bda );_fdc =_g .MakeArray (_dbfg ...);};_bdc .Params [0]=_fdc ;_bdc .Operand ="\u0054\u004a";return nil ;};func _beec (_cbca *targetMap ,_agdf []int ){var _aaec [][]int ;for _ffae ,_bgad :=range _cbca ._bgfa {if _dee (_ffae ,_agdf ){continue ;
};_aaec =append (_aaec ,_bgad );};_cbca ._bgfa =_aaec ;};type placeHolders struct{_gc []int ;_ec string ;_ag float64 ;};func _gegbc (_ddb string ,_cae []replacement ,_agda *_fd .PdfFont )[]_g .PdfObject {_faa :=[]_g .PdfObject {};_gbc :=0;_bff :=_ddb ;
for _bdae ,_bddg :=range _cae {_bad :=_bddg ._ef ;_fab :=_bddg ._afc ;_cdc :=_bddg ._ae ;_gfg :=_g .MakeFloat (_fab );if _gbc > _bad ||_bad ==-1{continue ;};_bga :=_ddb [_gbc :_bad ];_ede :=_bdf (_bga ,_agda );_cgc :=_g .MakeStringFromBytes (_ede );_faa =append (_faa ,_cgc );
_faa =append (_faa ,_gfg );_aaga :=_bad +len (_cdc );_bff =_ddb [_aaga :];_gbc =_aaga ;if _bdae ==len (_cae )-1{_ede =_bdf (_bff ,_agda );_cgc =_g .MakeStringFromBytes (_ede );_faa =append (_faa ,_cgc );};};return _faa ;};func _fdcf (_ddg *_b .ContentStreamOperations ,PdfObj _g .PdfObject )(*_b .ContentStreamOperation ,int ,bool ){for _beaf ,_fed :=range *_ddg {_cba :=_fed .Operand ;
if _cba =="\u0054\u006a"{_bdce :=_g .TraceToDirectObject (_fed .Params [0]);if _bdce ==PdfObj {return _fed ,_beaf ,true ;};}else if _cba =="\u0054\u004a"{_fgfe ,_ddcf :=_g .GetArray (_fed .Params [0]);if !_ddcf {return nil ,_beaf ,_ddcf ;};for _ ,_aagb :=range _fgfe .Elements (){if _aagb ==PdfObj {return _fed ,_beaf ,true ;
};};}else if _cba =="\u0022"{_aaf :=_g .TraceToDirectObject (_fed .Params [2]);if _aaf ==PdfObj {return _fed ,_beaf ,true ;};}else if _cba =="\u0027"{_gac :=_g .TraceToDirectObject (_fed .Params [0]);if _gac ==PdfObj {return _fed ,_beaf ,true ;};};};return nil ,-1,false ;
};func _ebc (_cg *_ca .TextMarkArray )int {_bef :=0;_cab :=_cg .Elements ();if _cab [0].Text =="\u0020"{_bef ++;};if _cab [_cg .Len ()-1].Text =="\u0020"{_bef ++;};return _bef ;};func _ggd (_dcc ,_bbe targetMap )(bool ,[]int ){_cdb :=_d .Contains (_dcc ._fbcad ,_bbe ._fbcad );
var _cdecb []int ;for _ ,_egcc :=range _dcc ._bgfa {for _fba ,_fgg :=range _bbe ._bgfa {if _fgg [0]>=_egcc [0]&&_fgg [1]<=_egcc [1]{_cdecb =append (_cdecb ,_fba );};};};return _cdb ,_cdecb ;};func _ce (_dg *_b .ContentStreamOperations ,_ega map[_g .PdfObject ][]localSpanMarks )error {for _ced ,_fc :=range _ega {if _ced ==nil {continue ;
};_fdf ,_da ,_gd :=_fdcf (_dg ,_ced );if !_gd {_eg .Log .Debug ("Pd\u0066\u004fb\u006a\u0065\u0063\u0074\u0020\u0025\u0073\u006e\u006ft\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0073\u0069\u0064\u0065\u0020\u0074\u0068\u0065\u0020\u0063\u006f\u006e\u0074\u0065\u006e\u0074\u0073\u0074r\u0065a\u006d\u0020\u006f\u0070\u0065\u0072\u0061\u0074i\u006fn\u0020\u0025s",_ced ,_dg );
return nil ;};if _fdf .Operand =="\u0054\u006a"{_ee :=_ccbc (_fdf ,_ced ,_fc );if _ee !=nil {return _ee ;};}else if _fdf .Operand =="\u0054\u004a"{_fg :=_ea (_fdf ,_ced ,_fc );if _fg !=nil {return _fg ;};}else if _fdf .Operand =="\u0027"||_fdf .Operand =="\u0022"{_fgc :=_eb (_dg ,_fdf .Operand ,_da );
if _fgc !=nil {return _fgc ;};_fgc =_ccbc (_fdf ,_ced ,_fc );if _fgc !=nil {return _fgc ;};};};return nil ;};func _dgef (_dcce *matchedIndex ,_fcfc [][]int )(bool ,[][]int ){_bfff :=[][]int {};for _ ,_ccee :=range _fcfc {if _dcce ._aef < _ccee [0]&&_dcce ._ebce > _ccee [1]{_bfff =append (_bfff ,_ccee );
};};return len (_bfff )> 0,_bfff ;};

// RedactionTerm holds the regexp pattern and the replacement string for the redaction process.
type RedactionTerm struct{Pattern *_fa .Regexp ;};func _ba (_bbg string ,_adg []localSpanMarks )([]placeHolders ,error ){_cca :="";_bea :=[]placeHolders {};for _bdg ,_cfae :=range _adg {_ccba :=_cfae ._eaad ;_eag :=_cfae ._aae ;_fbb :=_adcf (_ccba );_fdda ,_gbe :=_fdcd (_ccba );
if _gbe !=nil {return nil ,_gbe ;};if _fbb !=_cca {var _efb []int ;if _bdg ==0&&_eag !=_fbb {_gec :=_d .Index (_bbg ,_fbb );_efb =[]int {_gec };}else if _bdg ==len (_adg )-1{_ccbcb :=_d .LastIndex (_bbg ,_fbb );_efb =[]int {_ccbcb };}else {_efb =_gfb (_bbg ,_fbb );
};_edg :=placeHolders {_gc :_efb ,_ec :_fbb ,_ag :_fdda };_bea =append (_bea ,_edg );};_cca =_fbb ;};return _bea ,nil ;};type regexMatcher struct{_dfc RedactionTerm };type localSpanMarks struct{_eaad *_ca .TextMarkArray ;_gbf int ;_aae string ;};func (_bae *regexMatcher )match (_fdb string )([]*matchedIndex ,error ){_cad :=_bae ._dfc .Pattern ;
if _cad ==nil {return nil ,_f .New ("\u006e\u006f\u0020\u0070at\u0074\u0065\u0072\u006e\u0020\u0063\u006f\u006d\u0070\u0069\u006c\u0065\u0064");};var (_fefa =_cad .FindAllStringIndex (_fdb ,-1);_dgafc []*matchedIndex ;);for _ ,_acba :=range _fefa {_dgafc =append (_dgafc ,&matchedIndex {_aef :_acba [0],_ebce :_acba [1],_cbd :_fdb [_acba [0]:_acba [1]]});
};return _dgafc ,nil ;};

// New instantiates a Redactor object with given PdfReader and `regex` pattern.
func New (reader *_fd .PdfReader ,opts *RedactionOptions ,rectProps *RectangleProps )*Redactor {if rectProps ==nil {rectProps =RedactRectanglePropsNew ();};return &Redactor {_beag :reader ,_agc :opts ,_gfbb :_fb .New (),_baa :rectProps };};func _gfb (_gda ,_bfgb string )[]int {if len (_bfgb )==0{return nil ;
};var _fcf []int ;for _ccf :=0;_ccf < len (_gda );{_cfg :=_d .Index (_gda [_ccf :],_bfgb );if _cfg < 0{return _fcf ;};_fcf =append (_fcf ,_ccf +_cfg );_ccf +=_cfg +len (_bfgb );};return _fcf ;};func _dcda (_bdceb []int ,_afff *_ca .TextMarkArray ,_aca string )(*_ca .TextMarkArray ,matchedBBox ,error ){_gadg :=matchedBBox {};
_egf :=_bdceb [0];_dad :=_bdceb [1];_fag :=len (_aca )-len (_d .TrimLeft (_aca ,"\u0020"));_fcge :=len (_aca )-len (_d .TrimRight (_aca ,"\u0020\u000a"));_egf =_egf +_fag ;_dad =_dad -_fcge ;_aca =_d .Trim (_aca ,"\u0020\u000a");_eddg ,_fbbb :=_afff .RangeOffset (_egf ,_dad );
if _fbbb !=nil {return nil ,_gadg ,_fbbb ;};_gfdb ,_ceddc :=_eddg .BBox ();if !_ceddc {return nil ,_gadg ,_e .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_eddg );
};_gadg =matchedBBox {_deb :_aca ,_aacg :_gfdb };return _eddg ,_gadg ,nil ;};type targetMap struct{_fbcad string ;_bgfa [][]int ;};func _dff (_ebg localSpanMarks ,_aeg *_ca .TextMarkArray ,_ecfc *_fd .PdfFont ,_fdd ,_cd string )([]_g .PdfObject ,error ){_eaf :=_adcf (_aeg );
Tj ,_bgdc :=_fdcd (_aeg );if _bgdc !=nil {return nil ,_bgdc ;};_abc :=len (_fdd );_aeab :=len (_eaf );_gfc :=-1;_egcd :=_g .MakeFloat (Tj );if _eaf !=_cd {_gcd :=_ebg ._gbf ;if _gcd ==0{_gfc =_d .LastIndex (_fdd ,_eaf );}else {_gfc =_d .Index (_fdd ,_eaf );
};}else {_gfc =_d .Index (_fdd ,_eaf );};_ac :=_gfc +_aeab ;_eee :=[]_g .PdfObject {};if _gfc ==0&&_ac ==_abc {_eee =append (_eee ,_egcd );}else if _gfc ==0&&_ac < _abc {_acf :=_bdf (_fdd [_ac :],_ecfc );_gb :=_g .MakeStringFromBytes (_acf );_eee =append (_eee ,_egcd ,_gb );
}else if _gfc > 0&&_ac >=_abc {_fec :=_bdf (_fdd [:_gfc ],_ecfc );_gddg :=_g .MakeStringFromBytes (_fec );_eee =append (_eee ,_gddg ,_egcd );}else if _gfc > 0&&_ac < _abc {_abca :=_bdf (_fdd [:_gfc ],_ecfc );_cbb :=_bdf (_fdd [_ac :],_ecfc );_ebgf :=_g .MakeStringFromBytes (_abca );
_fac :=_g .MakeString (string (_cbb ));_eee =append (_eee ,_ebgf ,_egcd ,_fac );};return _eee ,nil ;};

// Redact executes the redact operation on a pdf file and updates the content streams of all pages of the file.
func (_fgd *Redactor )Redact ()error {_cggb ,_cdg :=_fgd ._beag .GetNumPages ();if _cdg !=nil {return _e .Errorf ("\u0066\u0061\u0069\u006c\u0065\u0064 \u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0074\u0068\u0065\u0020\u006e\u0075m\u0062\u0065\u0072\u0020\u006f\u0066\u0020P\u0061\u0067\u0065\u0073");
};_dggd :=_fgd ._baa .FillColor ;_dcdc :=_fgd ._baa .BorderWidth ;_cfaed :=_fgd ._baa .FillOpacity ;for _cbee :=1;_cbee <=_cggb ;_cbee ++{_bdfb ,_adb :=_fgd ._beag .GetPage (_cbee );if _adb !=nil {return _adb ;};_gaeb ,_adb :=_ca .New (_bdfb );if _adb !=nil {return _adb ;
};_ggc ,_ ,_ ,_adb :=_gaeb .ExtractPageText ();if _adb !=nil {return _adb ;};_edd :=_ggc .GetContentStreamOps ();_gfd ,_eeed ,_adb :=_fgd .redactPage (_edd ,_bdfb .Resources );if _eeed ==nil {_eg .Log .Info ("N\u006f\u0020\u006d\u0061\u0074\u0063\u0068\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066\u006f\u0072\u0020t\u0068\u0065\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065d \u0070\u0061\u0074t\u0061r\u006e\u002e");
_eeed =_edd ;};_ccbe :=_b .ContentStreamOperation {Operand :"\u006e"};*_eeed =append (*_eeed ,&_ccbe );_bdfb .SetContentStreams ([]string {_eeed .String ()},_g .NewFlateEncoder ());if _adb !=nil {return _adb ;};_afd ,_adb :=_bdfb .GetMediaBox ();if _adb !=nil {return _adb ;
};if _bdfb .MediaBox ==nil {_bdfb .MediaBox =_afd ;};if _dcdcg :=_fgd ._gfbb .AddPage (_bdfb );_dcdcg !=nil {return _dcdcg ;};_af .Slice (_gfd ,func (_gcfb ,_bde int )bool {return _gfd [_gcfb ]._deb < _gfd [_bde ]._deb });_gbb :=_afd .Ury ;for _ ,_dcf :=range _gfd {_cea :=_dcf ._aacg ;
_egeg :=_fgd ._gfbb .NewRectangle (_cea .Llx ,_gbb -_cea .Lly ,_cea .Urx -_cea .Llx ,-(_cea .Ury -_cea .Lly ));_egeg .SetFillColor (_dggd );_egeg .SetBorderWidth (_dcdc );_egeg .SetFillOpacity (_cfaed );if _fbbf :=_fgd ._gfbb .Draw (_egeg );_fbbf !=nil {return nil ;
};};};_fgd ._gfbb .SetOutlineTree (_fgd ._beag .GetOutlineTree ());return nil ;};func _dee (_cga int ,_acb []int )bool {for _ ,_eafe :=range _acb {if _eafe ==_cga {return true ;};};return false ;};func _fdcd (_cde *_ca .TextMarkArray )(float64 ,error ){_gdc ,_adga :=_cde .BBox ();
if !_adga {return 0.0,_e .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_cde );
};_efd :=_ebc (_cde );_edf :=0.0;_ ,_gdb :=_bec (_cde );_eda :=_cde .Elements ()[_gdb ];_eef :=_eda .Font ;if _efd > 0{_edf =_dc (_eef ,_eda );};_abb :=(_gdc .Urx -_gdc .Llx );_abb =_abb +_edf *float64 (_efd );Tj :=_dege (_abb ,_eda .FontSize ,_eda .Th );
return Tj ,nil ;};func _bec (_ge *_ca .TextMarkArray )(_g .PdfObject ,int ){var _de _g .PdfObject ;_dd :=-1;for _aa ,_aad :=range _ge .Elements (){_de =_aad .DirectObject ;_dd =_aa ;if _de !=nil {break ;};};return _de ,_dd ;};type matchedIndex struct{_aef int ;
_ebce int ;_cbd string ;};

// RedactionOptions is a collection of RedactionTerm objects.
type RedactionOptions struct{Terms []RedactionTerm ;};func _abd (_ddd *_ca .TextMarkArray ,_fff int ,_gcc int )int {_fggb :=_ddd .Elements ();_afab :=_fff -1;_cag :=_fff +1;_dgc :=-1;if _afab >=0{_gbbf :=_fggb [_afab ];_eeg :=_gbbf .ObjString ;_caec :=len (_eeg );
_facb :=_gbbf .Index ;if _facb +1< _caec {_dgc =_afab ;return _dgc ;};};if _cag < len (_fggb ){_dgf :=_fggb [_cag ];_eedg :=_dgf .ObjString ;if _eedg [0]!=_dgf .Text {_dgc =_cag ;return _dgc ;};};return _dgc ;};func _cge (_aefc []*matchedIndex ,_fefb [][]int )[]*matchedIndex {_dgae :=[]*matchedIndex {};
for _ ,_cgca :=range _aefc {_daf ,_ffe :=_dgef (_cgca ,_fefb );if _daf {_eccg :=_eca (_cgca ,_ffe );_dgae =append (_dgae ,_eccg ...);}else {_dgae =append (_dgae ,_cgca );};};return _dgae ;};func _gfcd (_caa RedactionTerm )(*regexMatcher ,error ){return &regexMatcher {_dfc :_caa },nil };
func _affa (_cbdd string )(string ,[][]int ){_aaag :=_fa .MustCompile ("\u005c\u006e");_gba :=_aaag .FindAllStringIndex (_cbdd ,-1);_ddgf :=_aaag .ReplaceAllString (_cbdd ,"\u0020");return _ddgf ,_gba ;};

// RedactRectanglePropsNew return a new pointer to a default RectangleProps object.
func RedactRectanglePropsNew ()*RectangleProps {return &RectangleProps {FillColor :_fb .ColorBlack ,BorderWidth :0.0,FillOpacity :1.0};};func _ccbd (_aafg []*matchedIndex )[]*targetMap {_dcca :=make (map[string ][][]int );_bgfd :=[]*targetMap {};for _ ,_adfe :=range _aafg {_aege :=_adfe ._cbd ;
_gcae :=[]int {_adfe ._aef ,_adfe ._ebce };if _bgg ,_egge :=_dcca [_aege ];_egge {_dcca [_aege ]=append (_bgg ,_gcae );}else {_dcca [_aege ]=[][]int {_gcae };};};for _ged ,_dab :=range _dcca {_ggb :=&targetMap {_fbcad :_ged ,_bgfa :_dab };_bgfd =append (_bgfd ,_ggb );
};return _bgfd ;};func _eca (_acbc *matchedIndex ,_degef [][]int )[]*matchedIndex {_eab :=[]*matchedIndex {};_bdcd :=_acbc ._aef ;_edgd :=_bdcd ;_cfbf :=_acbc ._cbd ;_cfc :=0;for _ ,_adfg :=range _degef {_fda :=_adfg [0]-_bdcd ;if _cfc >=_fda {continue ;
};_bfcd :=_cfbf [_cfc :_fda ];_cbcf :=&matchedIndex {_cbd :_bfcd ,_aef :_edgd ,_ebce :_adfg [0]};if len (_d .TrimSpace (_bfcd ))!=0{_eab =append (_eab ,_cbcf );};_cfc =_adfg [1]-_bdcd ;_edgd =_bdcd +_cfc ;};_adgg :=_cfbf [_cfc :];_abfb :=&matchedIndex {_cbd :_adgg ,_aef :_edgd ,_ebce :_acbc ._ebce };
if len (_d .TrimSpace (_adgg ))!=0{_eab =append (_eab ,_abfb );};return _eab ;};func _egc (_beb *_ca .TextMarkArray )*_fd .PdfFont {_ ,_gdf :=_bec (_beb );_df :=_beb .Elements ()[_gdf ];_bgff :=_df .Font ;return _bgff ;};

// WriteToFile writes the redacted document to file specified by `outputPath`.
func (_eegb *Redactor )WriteToFile (outputPath string )error {if _gea :=_eegb ._gfbb .WriteToFile (outputPath );_gea !=nil {return _e .Errorf ("\u0066\u0061\u0069l\u0065\u0064\u0020\u0074o\u0020\u0077\u0072\u0069\u0074\u0065\u0020t\u0068\u0065\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0066\u0069\u006c\u0065");
};return nil ;};func _eb (_efe *_b .ContentStreamOperations ,_bd string ,_cc int )error {_bf :=_b .ContentStreamOperations {};var _ad _b .ContentStreamOperation ;for _dgg ,_cf :=range *_efe {if _dgg ==_cc {if _bd =="\u0027"{_be :=_b .ContentStreamOperation {Operand :"\u0054\u002a"};
_bf =append (_bf ,&_be );_ad .Params =_cf .Params ;_ad .Operand ="\u0054\u006a";_bf =append (_bf ,&_ad );}else if _bd =="\u0022"{_ecd :=_cf .Params [:2];Tc ,Tw :=_ecd [0],_ecd [1];_db :=_b .ContentStreamOperation {Params :[]_g .PdfObject {Tc },Operand :"\u0054\u0063"};
_bf =append (_bf ,&_db );_db =_b .ContentStreamOperation {Params :[]_g .PdfObject {Tw },Operand :"\u0054\u0077"};_bf =append (_bf ,&_db );_ad .Params =[]_g .PdfObject {_cf .Params [2]};_ad .Operand ="\u0054\u006a";_bf =append (_bf ,&_ad );};};_bf =append (_bf ,_cf );
};*_efe =_bf ;return nil ;};

// Redactor represents a Redactor object.
type Redactor struct{_beag *_fd .PdfReader ;_agc *RedactionOptions ;_gfbb *_fb .Creator ;_baa *RectangleProps ;};type matchedBBox struct{_aacg _fd .PdfRectangle ;_deb string ;};func (_dcdf *Redactor )redactPage (_agbb *_b .ContentStreamOperations ,_acd *_fd .PdfPageResources )([]matchedBBox ,*_b .ContentStreamOperations ,error ){_aff ,_ded :=_ca .NewFromContents (_agbb .String (),_acd );
if _ded !=nil {return nil ,nil ,_ded ;};_fae ,_ ,_ ,_ded :=_aff .ExtractPageText ();if _ded !=nil {return nil ,nil ,_ded ;};_agbb =_fae .GetContentStreamOps ();_fbee :=_fae .Marks ();_bgfe :=_fae .Text ();_bgfe ,_cfe :=_affa (_bgfe );_ddbf :=[]matchedBBox {};
_aafd :=make (map[_g .PdfObject ][]localSpanMarks );_ggac :=[]*targetMap {};for _ ,_fcg :=range _dcdf ._agc .Terms {_dgage ,_bdgb :=_gfcd (_fcg );if _bdgb !=nil {return nil ,nil ,_bdgb ;};_eba ,_bdgb :=_dgage .match (_bgfe );if _bdgb !=nil {return nil ,nil ,_bdgb ;
};_eba =_cge (_eba ,_cfe );_eea :=_ccbd (_eba );_ggac =append (_ggac ,_eea ...);};_gggg (_ggac );for _ ,_fad :=range _ggac {_eccd :=_fad ._fbcad ;_deac :=_fad ._bgfa ;_aafe :=[]matchedBBox {};for _ ,_agcb :=range _deac {_gage ,_cdec ,_ggg :=_dcda (_agcb ,_fbee ,_eccd );
if _ggg !=nil {return nil ,nil ,_ggg ;};_egg :=_gfdf (_gage );for _efa ,_ecdbe :=range _egg {_aagg :=localSpanMarks {_eaad :_ecdbe ,_gbf :_efa ,_aae :_eccd };_bcac ,_ :=_bec (_ecdbe );if _degd ,_ffa :=_aafd [_bcac ];_ffa {_aafd [_bcac ]=append (_degd ,_aagg );
}else {_aafd [_bcac ]=[]localSpanMarks {_aagg };};};_aafe =append (_aafe ,_cdec );};_ddbf =append (_ddbf ,_aafe ...);};_ded =_ce (_agbb ,_aafd );if _ded !=nil {return nil ,nil ,_ded ;};return _ddbf ,_agbb ,nil ;};

// Write writes the content of `re.creator` to writer of type io.Writer interface.
func (_efg *Redactor )Write (writer _a .Writer )error {return _efg ._gfbb .Write (writer )};type replacement struct{_ae string ;_afc float64 ;_ef int ;};